<script>
//$("#listing-timer-<%= listing.id %>").countdown({until:<%= (listing.duration - (Time.now - listing.start_date) ).to_i %> });

<% if user_signed_in? %>
	$("#bid-<%= listing.id %>").on("click", function(){
    $.post('/listings/<%= listing.id %>/bids', { user_id: "<%= current_user.id %>" })
	})
<% else %>

<% end %>

var get_listing_values = function(){
	$.getJSON('/listings/active.json', function(listing) { 
			$.each(listing, function(i, listing) {
				//console.log("#listing-timer-" + listing.id)
				//console.log(listing.current_price)
				//$(listing.seconds_to_end).appendTo($("#listing-timer-" + listing.id));	
				//$(listing.current_price).appendTo($("#listing-price-" + listing.id));	

				$("#listing-timer-" + listing.id).html(("Ending in: "+listing.seconds_to_end));
				$("#listing-price-" + listing.id).html(("Highest bid: "+listing.current_price));
				$("#listing-user-" + listing.current_winner).html(("Currently winning: "+listing.current_winner));


			})
	})
}

setInterval(get_listing_values,1000)

</script>

